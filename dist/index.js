var t=[],e=[];!function(i,o){if(i&&"undefined"!=typeof document){var s,n=!0===o.prepend?"prepend":"append",a=!0===o.singleTag,r="string"==typeof o.container?document.querySelector(o.container):document.getElementsByTagName("head")[0];if(a){var l=t.indexOf(r);-1===l&&(l=t.push(r)-1,e[l]={}),s=e[l]&&e[l][n]?e[l][n]:e[l][n]=d()}else s=d();65279===i.charCodeAt(0)&&(i=i.substring(1)),s.styleSheet?s.styleSheet.cssText+=i:s.appendChild(document.createTextNode(i))}function d(){var t=document.createElement("style");if(t.setAttribute("type","text/css"),o.attributes)for(var e=Object.keys(o.attributes),i=0;i<e.length;i++)t.setAttribute(e[i],o.attributes[e[i]]);var s="prepend"===n?"afterbegin":"beforeend";return r.insertAdjacentElement(s,t),t}}(".editor-js-audio-plugin {\n  display: grid;\n  grid-gap: 16px;\n}\n.editor-js-audio-plugin__cover {\n  display: grid;\n}\n.editor-js-audio-plugin__cover-image {\n  position: relative;\n  width: 100%;\n  height: 250px;\n  border-radius: 5px;\n  overflow: hidden;\n}\n.editor-js-audio-plugin__cover-image img {\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  background: #fafafa;\n  object-position: center;\n  border-radius: 5px;\n}\n.editor-js-audio-plugin__audio-player {\n  position: relative;\n  display: inline-flex;\n  align-items: center;\n  gap: 16px;\n}\n.editor-js-audio-plugin__close {\n  position: absolute;\n  right: 8px;\n  top: 8px;\n  width: 26px;\n  height: 26px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  border: none;\n  background: #e9e9e9;\n  border-radius: 5px;\n  cursor: pointer;\n}\n.editor-js-audio-plugin__close:hover {\n  background: #e2e2e2;\n}\n.editor-js-audio-plugin__close svg {\n  width: 24px;\n  height: 24px;\n}\n.editor-js-audio-plugin__audio {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  grid-gap: 16px;\n}\n.editor-js-audio-plugin .cdx-button {\n  position: relative;\n}\n.editor-js-audio-plugin .cdx-button input[type='file'] {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 0;\n  height: 0;\n}\n",{});class i{rootClass="editor-js-audio-plugin";title=null;cover=null;audio=null;headers={};uploadFileName="file";imageLoading=!1;audioLoading=!1;endpoint="/";audioSvg='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 13.535V3h8v2h-6v12a4 4 0 1 1-2-3.465zM10 19a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></svg>';constructor({data:t,api:e,config:i}){this.title=t.title,this.audio=t.audio,this.cover=t.cover,this.api=e,i&&(i.headers&&(this.headers=i.headers),i.endpoint&&(this.endpoint=i.endpoint),i.uploadFileName&&(this.uploadFileName=i.uploadFileName))}render(){return this.root=document.createElement("div"),this.root.classList.add(this.rootClass),this.root.classList.add("cdx-block"),this.redraw(),this.root}async handleFileUpload(t){if(t.target.files[0]){let e=new FormData;return e.append(this.uploadFileName,t.target.files[0]),(await fetch(this.endpoint,{method:"POST",headers:this.headers,body:e}).then((t=>t.json()))).file}}redraw(){let t=`<label class="cdx-button ${this.rootClass}__cover-file">\n      <input type="file" class="${this.rootClass}__hidden" accept="image/*" />\n      <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.15 13.628A7.749 7.749 0 0 0 10 17.75a7.74 7.74 0 0 0 6.305-3.242l-2.387-2.127-2.765 2.244-4.389-4.496-3.614 3.5zm-.787-2.303l4.446-4.371 4.52 4.63 2.534-2.057 3.533 2.797c.23-.734.354-1.514.354-2.324a7.75 7.75 0 1 0-15.387 1.325zM10 20C4.477 20 0 15.523 0 10S4.477 0 10 0s10 4.477 10 10-4.477 10-10 10z"></path></svg>\n      <span>Добавить изображение</span>\n    </label>`,e=`<div class="${this.rootClass}__cover-image">\n      <img alt="" src="${this.cover||""}" />\n      <button type="button" class="${this.rootClass}__close"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"/></svg></button>\n    </div>`,i=`<label class="cdx-button ${this.rootClass}__audio-file  ${this.audioLoading?"cdx-loader":""}">\n      <input type="file" class="${this.rootClass}__hidden" accept="audio/*" />\n      ${this.audioSvg}\n      <span>Загрузить аудио-файл</span>\n    </label>`,o=`<div class="${this.rootClass}__audio-player cdx-button">\n      <audio controls src="${this.audio}"></audio>\n      <button class="${this.rootClass}__close" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"/></svg></button>\n    </div>`;this.root.innerHTML=`<div class="${this.rootClass}__cover ${this.imageLoading?"cdx-loader":""}">${this.cover?e:t}</div>\n    <div class="${this.rootClass}__audio">\n      <input type="text" class="${this.rootClass}__audio-title cdx-input" placeholder="Название" />\n      ${this.audio?o:i}\n    </div>`;let s=this.root.querySelector(`.${this.rootClass}__cover`);if(this.cover){let t=s.querySelector(`.${this.rootClass}__cover-image button`);this.api.listeners.on(t,"click",(t=>{confirm("Вы уверены?")&&(this.cover=null,this.redraw())}),!1)}else{let t=s.querySelector(`.${this.rootClass}__cover-file input`);this.api.listeners.on(t,"input",(t=>{this.imageLoading=!0,this.redraw(),this.handleFileUpload(t).then((t=>{this.cover=t})).catch((t=>{console.error(t.message)})).finally((()=>{this.imageLoading=!1,this.redraw()}))}),!1)}let n=this.root.querySelector(`.${this.rootClass}__audio`),a=n.querySelector(`.${this.rootClass}__audio-title`);if(a.value=this.title||"",this.api.listeners.on(a,"input",(t=>{this.title=t.target.value}),!1),this.audio)this.api.listeners.on(n.querySelector(`.${this.rootClass}__audio-player button`),"click",(()=>{confirm("Вы уверены?")&&(this.audio=null,this.redraw())}),!1);else{let t=n.querySelector(`.${this.rootClass}__audio-file input`);this.api.listeners.on(t,"input",(t=>{this.audioLoading=!0,this.redraw(),this.handleFileUpload(t).then((t=>{this.audio=t})).catch((t=>{console.error(t.message)})).finally((()=>{this.audioLoading=!1,this.redraw()}))}),!1)}}save(){return{title:this.title,audio:this.audio,cover:this.cover}}static get toolbox(){return{title:"Аудио",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 13.535V3h8v2h-6v12a4 4 0 1 1-2-3.465zM10 19a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></svg>'}}}export{i as default};
//# sourceMappingURL=index.js.map
